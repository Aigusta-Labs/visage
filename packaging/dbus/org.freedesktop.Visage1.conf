<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<!--
  D-Bus session policy for org.freedesktop.Visage1.

  Step 3 uses the session bus â€” no policy file is required for development.
  This file is provided for reference and future system bus migration (Step 4,
  when PAM integration requires system bus access from a root-owned process).

  For system bus deployment, install to:
    /usr/share/dbus-1/system.d/org.freedesktop.Visage1.conf

  For session bus deployment (current), this file is unused.
-->
<busconfig>
  <policy user="root">
    <allow own="org.freedesktop.Visage1"/>
  </policy>

  <!--
    Allow any local user to call the Visage1 interface.
    The daemon enforces per-user scoping internally (all methods
    require an explicit 'user' argument and the store applies
    WHERE user = ? guards on all mutations).
  -->
  <policy context="default">
    <allow send_destination="org.freedesktop.Visage1"
           send_interface="org.freedesktop.Visage1"/>
    <allow send_destination="org.freedesktop.Visage1"
           send_interface="org.freedesktop.DBus.Introspectable"/>
    <allow send_destination="org.freedesktop.Visage1"
           send_interface="org.freedesktop.DBus.Properties"/>
  </policy>
</busconfig>
